---
title: 31天Javascript学习-第3天
reprint: false
date: 2022-02-22 18:43:34
updated: 2022-02-22 18:43:34
conver:
categories: 前端
tags:
  - JavaScript
---

# 内置引用类型（一）——Object、Array、Date

<!--more-->

ES中引用类型是一种数据结构，有时也称为**对象定义**。ES对内置对象（引用类型的值）的定义是：由ES实现提供的、不依赖于宿主环境的对象，这些对象在ES程序执行前就已经存在了。

类似的：

- 引用类型			类
- 引用类型的值	对象

对象是某个特定引用类型的实例，ES提供很多原生引用类型以方便开发使用。

## Object

大多**引用类型值**都是Object类型的实例。创建Object实例方式有两种：

- new操作符后跟Object构造函数
- 对象字面量

访问对象属性有两种方法：

- 点表示法 `person.name`
- 方括号表示法 `person["name"]`

## Array

ES的数组的每一项可以保存任意类型的数据。创建数据有两种方式：

**使用字面量**

`var arr1 = [1, 2];`

**使用构造函数**

`let arr = new Array(args);`

如果参数为空，则表示创建一个空数组；如果参数为数值，则表示数组的长度；如果有多个参数，表示数组中的元素。

### 稀疏数组与密集数组

- 稀疏数组：索引不连续、数组长度大于元素个数的数组，可以简单理解为有 `empty`（有空隙）的数组。
- 密集数组：索引连续、数组长度等于元素个数的数组。

数组的项数保存在其length属性中，该属性**不是只读**的，因此可以人为修改该属性。

- 如果修改的 length 大于原长度，则多出部分会空出来，置为 undefined。
- 如果修改的 length 小于原长度，则多出的元素会被删除，数组将从后面删除元素。

```js
let arr = new Array(5);
// 等价于
let arr = [];
arr.length = 5;
// 此时返回一个length的值等于5的数组对象，但数组并不包含任何实际的元素，不能理解成包含5个值为undefined的元素
console.log(arr); // [ <5 empty items> ]
```

#### empty和undefined

从上面的例子可以看出，使用`new Array(len)`创建的数组，输出是一个包含len个empty元素的数组。empty并不是JS的基础数据类型之一，但它到底是什么呢？

```js
console.log(arr[0]); // undefined
```

当访问empty元素时，输出了undefined，empty和undefined是等价的？

```js
let arr = new Array(4);
let arr_undefined = [undefined, undefined];
console.log(arr); // [ <4 empty items> ]
console.log(arr_undefined); // [ undefined, undefined ]
console.log(arr[0]); // undefined
console.log(arr_undefined[0]); // undefined

console.log(arr[0] == arr_undefined[0]); // true
console.log(arr[0] === arr_undefined[0]); // true

arr.forEach(item => {console.log(item);}) //undefined
arr_undefined.forEach(item => {console.log(item);}) // undefined
console.log(arr.hasOwnProperty(0)); // false
console.log(arr_undefined.hasOwnProperty(0)); // true
```

可以看到，只有在访问具体单个元素的时候，empty和undefined才表现一致，其余情况并不相同。

empty是v8引擎对一个空的对象引用的描述，但JS中不存在这种基本类型，因此使用undefined表示。

在用for循环对empty数组遍历，会将empty转换为undefined，而`forEach()`会自动忽略empty。

#### 数组的常见方法

##### 检测方法

| 方法            | 描述           | 备注 |
| :-------------- | :------------- | :--: |
| Array.isArray() | 判断是否为数组 |      |

##### 转换方法

| 方法             | 描述               | 备注                                               |
| ---------------- | ------------------ | -------------------------------------------------- |
| toString()       | 将数组转换为字符串 | 创建字符串会调用数组中每一项的toString()方法       |
| valueOf()        | 返回数组本身       |                                                    |
| toLocaleString() | 将数组转换为字符串 | 创建字符串会调用数组中每一项的toLocaleString()方法 |

##### 栈方法

| 方法   | 描述                                               | 备注 |
| ------ | -------------------------------------------------- | ---- |
| push() | 向数组末尾插入一个或多个元素，返回修改后数组的长度 |      |
| pop()  | 从数组末尾移除一个元素，返回修改后数组的长度       |      |

##### 队列方法

| 方法      | 描述                                               | 备注 |
| --------- | -------------------------------------------------- | ---- |
| unshift() | 向数组头部插入一个或多个元素，返回修改后数组的长度 |      |
| shift()   | 从数组头部移除一个元素，返回修改后数组的长度       |      |

##### 重排序方法

| 方法      | 描述                                                         | 备注 |
| --------- | ------------------------------------------------------------ | ---- |
| reverse() | 对数组反转                                                   |      |
| sort()    | 按升序排列数组项，按照Unicode编码，对每个数组项调用toString() |      |

如果在使用sort()方法**不带参**，默认按照**Unicode编码**，对数组元素从小到大排序。

```js
let arr = [1, 2, 3, 5, 10, 11];
console.log(arr.sort()); // [ 1, 10, 11, 2, 3, 5 ]
```

可以看到，数字11排在了2的前面，因为`sort()`方法是按照**Unicode编码**进行排序的。

sort()方法可以接收一个比较函数作为参数，以便指定比较的规则。在sort()添加一个回调函数，回调函数中需要定义两个形参，浏览器会分别使用数组中的元素作为实参去调用回调函数。

浏览器会根据回调函数的返回值来决定元素的排序：

- **如果返回一个大于 0 的值，则元素会交换位置**
- **如果返回一个小于 0 的值，则元素位置不变**
- **如果返回一个等于 0 的值，则认为两个元素相等，则不交换位置**

下面是一个简单的比较函数：

```js
let arr = [1, 2, 3, 5, 10, 11];

function compare(value1, value2) {
  if (value1 < value2) {
    return -1;
  } else if (value1 > value2) {
    return 1;
  } else {
    return 0
  }
}

console.log(arr.sort(compare)); // [ 1, 2, 3, 5, 10, 11 ]
```

更简化的写法：

```js
let arr = [1, 2, 3, 5, 10, 11];

let result = arr.sort(function (a, b){
  return a - b; // 升序
});

console.log(result); // [ 1, 2, 3, 5, 10, 11 ]
```

或箭头函数（推荐）：

```js
let arr = [1, 2, 3, 5, 10, 11];

let result = arr.sort((a, b) => a - b);

console.log(result); // [ 1, 2, 3, 5, 10, 11 ]
```

##### 操作方法

| 方法     | 描述                                                         | 备注           |
| -------- | ------------------------------------------------------------ | -------------- |
| concat() | 合并数组，返回一个**新的数组**                               | 不会改变原数组 |
| slice()  | 从数组中**提取**指定的一个或多个元素，返回结果为**新的数组** | 不会改变原数组 |
| splice() | 从数组中**删除**指定的一个或多个元素，返回结果为**被删除元素组成的新数组** | 会改变原数组   |

splice()有三种使用方法：

- **删除：**传入两参。起始位置，删除的项数
- **插入：**传入三个或三个以上的参数。起始位置，0，插入的元素
- **替换：**传入三个或三个以上的参数。起始位置，要删除的项数，插入的元素

##### 位置方法

| 方法          | 描述                                           | 备注 |
| ------------- | ---------------------------------------------- | ---- |
| indexOf()     | 从前往后索引，检索一个数组中是否含有指定的元素 |      |
| lastIndexOf() | 从后往前索引，检索一个数组中是否含有指定的元素 |      |

##### 迭代方法

| 方法      | 描述                                                         | 备注                                                   |
| --------- | ------------------------------------------------------------ | ------------------------------------------------------ |
| every()   | 确保数组中的每个元素都满足「指定条件返回 true」，则停止遍历，此方法才返回 true |                                                        |
| filter()  | 过滤数组：返回结果是 true 的项，将组成新的数组，返回结果为**新的数组** | 不会改变原数组                                         |
| forEach() | 和 for 循环类似，但需要兼容 IE8 以上                         | forEach() 没有返回值。也就是说，它的返回值是 undefined |
| map()     | 过滤数组：返回结果是 true 的项，将组成新的数组，返回结果为**新的数组** | 不会改变原数组                                         |
| some()    | 数组中只要有一个元素满足「指定条件返回 true」，则停止遍历，此方法就返回 true | 一真即真。只要有一项返回 true，最终的结果就返回 true   |

##### 归并方法

| 方法          | 描述                                                         | 备注 |
| ------------- | ------------------------------------------------------------ | ---- |
| reduce()      | 接收一个函数作为累加器，返回值是回调函数累计处理的结果       |      |
| reduceRight() | 接收一个函数作为累加器，返回值是回调函数累计处理的结果，方向相反 |      |

reduce()函数接收4个参数：前一个值，当前值，项的索引和数组对象。常见可用于数组求和等：

```js
let arr = [1, 2, 3, 5, 10, 11];

let result = arr.reduce(function(prev, cur, index, array){
  return prev + cur;
});

console.log(result); // 32
```

## Date

### 创建Date对象

`var now = new Date()`

在调用构造函数而不传递参数的情况下，自动获得当前日期和时间。若想根据特定的日期和时间创建Date对象，则需传入该日期的毫秒数（即UTC时间1970年1月1日00:00:00）。为简化该计算过程，ES提供两个方法：Date.parse()，Date.UTC()。

实际上，如果直接将表示日期的字符串传递给Date构造函数，也会在后台调用Date.parse()

